#cfg <- modifyList(build_cfg(d = 2), list(M = 500, label = "M500", use_tail_informed_prior = TRUE, tip_k=25))
# --- Run your method ---
#out <- naive_simul_d2_regimes(data, cfg, dgp)
out <- smc_simul_serial(data, cfg, dgp)
n_oos <- nrow(data$U) - cfg$W_predict
y_real_oos  <- data$y_real[(nrow(data$y_real) - n_oos + 1):nrow(data$y_real), , drop = FALSE]
rp_real_oos <- rowMeans(y_real_oos)
eval_var <- port_var_backtest_df(out, rp_real_oos, cfg$alphas)
grid_ab_use <- rbind(
data.frame(alpha_j=0.10,  alpha_port=0.10),
data.frame(alpha_j=0.10,  alpha_port=0.05),
data.frame(alpha_j=0.05,  alpha_port=0.10),
data.frame(alpha_j=0.05,  alpha_port=0.05),
data.frame(alpha_j=0.05,  alpha_port=0.025),  # NEW
data.frame(alpha_j=0.025, alpha_port=0.05)    # NEW
)
eval_covar <- covar_backtest_grid(
out         = out,
y_real_oos  = y_real_oos,
rp_real_oos = rp_real_oos,
cfg_alphas  = cfg$alphas,
grid_ab     = grid_ab_use,
d           = d
)
rmse_mae_from_covar <- covar_rmse_mae_all(out, dgp)
eval_covar_asset <- covar_backtest_grid_asset(
out         = out,
y_real_oos  = y_real_oos,
rp_real_oos = rp_real_oos,
cfg_alphas  = cfg$alphas,
grid_ab     = grid_ab_use,
d           = d
)
eval_var$sim   <- s
eval_covar$sim <- s
# result <- list(
#   eval_var  = eval_var,
#   eval_covar = eval_covar,
#   log_pred  = out$log_pred,
#   QL        = apply(out$port$QL, 2, sum),
#   FZL       = apply(out$port$FZL, 2, sum),
#   wCRPS     = sum(out$port$wCRPS),
#   rmse_mae_from_covar = rmse_mae_from_covar
# )
#dir.create(out_dir, recursive = TRUE, showWarnings = FALSE)
#saveRDS(result, file.path(out_dir, sprintf("results_smc_regimes_tip_s%03d.rds", s)))
result <- list(
eval_var  = eval_var,
eval_covar = eval_covar,
eval_covar_asset = eval_covar_asset,
log_pred  = out$log_pred,
QL        = apply(out$port$QL, 2, sum),
FZL       = apply(out$port$FZL, 2, sum),
wCRPS     = sum(out$port$wCRPS),
rmse_mae_from_covar = rmse_mae_from_covar,
dgp       =dgp,
# record grid identifiers in each file (handy later)
mean_len  = mean_len,
p_extreme = p_extreme,
tip_k     = tip_k,
sim       = s,
sched = sched,
piece = piece,
data = data,
dgp = dgp$truth,
cfg = cfg
)
dir.create(out_dir, recursive = TRUE, showWarnings = FALSE)
f_final <- file.path(out_dir, sprintf("sim_%03d.rds", s))
f_tmp   <- paste0(f_final, ".tmp")
saveRDS(result, f_tmp)
file.rename(f_tmp, f_final)
return(f_final)  # return only the filename (lightweight)
}, error = function(e) {
# save error so you can inspect failures later
dir.create(out_dir, recursive = TRUE, showWarnings = FALSE)
f_final <- file.path(out_dir, sprintf("sim_%03d_ERROR.rds", s))
saveRDS(list(
sim = s,
mean_len = mean_len,
p_extreme = p_extreme,
tip_k = tip_k,
error = conditionMessage(e)
), f_final)
return(f_final)
})
}
########
#loop
library(future)
library(future.apply)
set.seed(1111)
plan(multisession, workers = max(1, parallel::detectCores() - 1))
library(here)
source(here("src/R", "config.R"))
source(here("src/simulation/naive_simulation.R"))
source(here("src/simulation/main_simulation_nonparallel.R"))
mean_len_grid  <- c(1e10, 500)
#p_extreme_grid <- c(0.00)
#W_grid     <- c(252)  #AIC
W_grid     <- c(252, 126, 504)  #SMC
#aic_refit_every_grid <- c(252, 63) #AIC
aic_refit_every_grid <- c(1) #SMC
#W_predict_grid <- c(252) #AIC
W_predict_grid <- c(1000) #SMC
base_dir <- "simul_results/SMC_M500"
dir.create(base_dir, recursive = TRUE, showWarnings = FALSE)
set.seed(11111)
#loop
library(future)
library(future.apply)
set.seed(11111)
plan(multisession, workers = max(1, parallel::detectCores() - 1))
library(here)
source(here("src/R", "config.R"))
source(here("src/simulation/naive_simulation.R"))
source(here("src/simulation/main_simulation_nonparallel.R"))
for (ml in mean_len_grid) {
#for (pe in p_extreme_grid) {
for (w in W_grid) {
for (wp in W_predict_grid) {
for (re in aic_refit_every_grid) {
cfg <- modifyList(build_cfg(d = 2), list(M = 500, label = "M500", W_predict=wp, aic_refit_every = re, W=w,  use_tail_informed_prior = TRUE))
n_train <- cfg$W_predict
d       <- 2
n_test  <- 2000
n       <- n_train+n_test
tag <- sprintf(
"ml%s_w%03d_wp%04d_re%03d",
formatC(ml, format = "d"),
#as.integer(round(100 * pe)),  # 0.20 -> 020
w,
wp,
re
)
out_dir <- file.path(base_dir, tag)
dir.create(out_dir, recursive = TRUE, showWarnings = FALSE)
cat("\n============================\n")
cat("Running:", tag, "\n")
cat("============================\n")
sim_files <- future_lapply(
X = 1:300,
FUN = run_one_sim,
n_train   = n_train,
n_test    = n_test,
d         = d,
cfg       = cfg,
mean_len  = ml,
out_dir   = out_dir,
future.seed = 11111
)
saveRDS(sim_files, file.path(out_dir, sprintf("sim_files_%s.rds", tag)))
}
}
}
#}
}
plan(sequential)
folder <- "simul_results/NAIVE/mlNA_w252_wp0252_re252"   # <- change this
files  <- list.files(folder, pattern = "\\.rds$", full.names = TRUE)
obj_list <- lapply(files, readRDS)
covar_list <- lapply(obj_list, `[[`, "rmse_mae_from_covar")
covar_list <- lapply(obj_list, `[[`, "eval_covar")
covar_list <- Filter(Negate(is.null), covar_list)
covar_all <- do.call(rbind, covar_list)
with(covar_all, mean(rate[asset == 2 & alpha_j == 0.1 & alpha_port == 0.05], na.rm = TRUE))
with(covar_all, mean(rate[asset == 2 & alpha_j == 0.05 & alpha_port == 0.025], na.rm = TRUE))
folder <- "simul_results/SMC/mlNA_w252_wp1000_re001"   # <- change this
files  <- list.files(folder, pattern = "\\.rds$", full.names = TRUE)
# read all files (each file is assumed to be a list)
obj_list <- lapply(files, readRDS)
# extract the element you want (file[[1]]$covar, file[[2]]$covar, ...)
covar_list <- lapply(obj_list, `[[`, "rmse_mae_from_covar")
covar_list <- lapply(obj_list, `[[`, "eval_covar")
# (optional) keep only non-missing covar elements
covar_list <- Filter(Negate(is.null), covar_list)
# bind vertically
covar_all <- do.call(rbind, covar_list)
with(covar_all, mean(rate[asset == 2 & alpha_j == 0.1 & alpha_port == 0.05], na.rm = TRUE))
with(covar_all, mean(rate[asset == 2 & alpha_j == 0.05 & alpha_port == 0.025], na.rm = TRUE))
with(covar_all, mean(rate[asset == 2 & alpha_j == 0.05 & alpha_port == 0.05], na.rm = TRUE))
folder <- "simul_results/NAIVE/mlNA_w252_wp0252_re252"   # <- change this
files  <- list.files(folder, pattern = "\\.rds$", full.names = TRUE)
obj_list <- lapply(files, readRDS)
covar_list <- lapply(obj_list, `[[`, "rmse_mae_from_covar")
covar_list <- lapply(obj_list, `[[`, "eval_covar")
covar_list <- Filter(Negate(is.null), covar_list)
covar_all <- do.call(rbind, covar_list)
with(covar_all, mean(rate[asset == 2 & alpha_j == 0.05 & alpha_port == 0.05], na.rm = TRUE))
folder <- "simul_results/NAIVE/mlNA_w252_wp0252_re252"   # <- change this
files  <- list.files(folder, pattern = "\\.rds$", full.names = TRUE)
obj_list <- lapply(files, readRDS)
covar_list <- lapply(obj_list, `[[`, "rmse_mae_from_covar")
covar_list <- Filter(Negate(is.null), covar_list)
covar_all <- do.call(rbind, covar_list)
with(covar_all, mean(RMSE[cond_asset == 2 & scenario == "a0.1b0.05"], na.rm = TRUE))
with(covar_all, mean(MAE[cond_asset == 2 & scenario == "a0.1b0.05"], na.rm = TRUE))
with(covar_all, mean(RMSE[cond_asset == 2 & scenario == "a0.05b0.05"], na.rm = TRUE))
with(covar_all, mean(MAE[cond_asset == 2 & scenario == "a0.05b0.05"], na.rm = TRUE))
with(covar_all, mean(RMSE[cond_asset == 2 & scenario == "a0.05b0.025"], na.rm = TRUE))
with(covar_all, mean(MAE[cond_asset == 2 & scenario == "a0.05b0.025"], na.rm = TRUE))
folder <- "simul_results/SMC/mlNA_w252_wp1000_re001"   # <- change this
files  <- list.files(folder, pattern = "\\.rds$", full.names = TRUE)
# read all files (each file is assumed to be a list)
obj_list <- lapply(files, readRDS)
# extract the element you want (file[[1]]$covar, file[[2]]$covar, ...)
covar_list <- lapply(obj_list, `[[`, "rmse_mae_from_covar")
# (optional) keep only non-missing covar elements
covar_list <- Filter(Negate(is.null), covar_list)
# bind vertically
covar_all <- do.call(rbind, covar_list)
with(covar_all, mean(RMSE[cond_asset == 2 & scenario == "a0.1b0.05"], na.rm = TRUE))
0.007155185/0.006784644
with(covar_all, mean(MAE[cond_asset == 2 & scenario == "a0.1b0.05"], na.rm = TRUE))
with(covar_all, mean(RMSE[cond_asset == 2 & scenario == "a0.05b0.05"], na.rm = TRUE))
with(covar_all, mean(MAE[cond_asset == 2 & scenario == "a0.05b0.05"], na.rm = TRUE))
0.006915297/0.006698681
with(covar_all, mean(RMSE[cond_asset == 2 & scenario == "a0.05b0.025"], na.rm = TRUE))
with(covar_all, mean(MAE[cond_asset == 2 & scenario == "a0.05b0.025"], na.rm = TRUE))
folder <- "simul_results/NAIVE/mlNA_w504_wp0252_re252"   # <- change this
files  <- list.files(folder, pattern = "\\.rds$", full.names = TRUE)
obj_list <- lapply(files, readRDS)
covar_list <- lapply(obj_list, `[[`, "rmse_mae_from_covar")
covar_list <- lapply(obj_list, `[[`, "eval_covar")
covar_list <- Filter(Negate(is.null), covar_list)
covar_all <- do.call(rbind, covar_list)
with(covar_all, mean(rate[asset == 2 & alpha_j == 0.1 & alpha_port == 0.05], na.rm = TRUE))
folder <- "simul_results/SMC/mlNA_w504_wp1000_re001"   # <- change this
files  <- list.files(folder, pattern = "\\.rds$", full.names = TRUE)
# read all files (each file is assumed to be a list)
obj_list <- lapply(files, readRDS)
# extract the element you want (file[[1]]$covar, file[[2]]$covar, ...)
covar_list <- lapply(obj_list, `[[`, "rmse_mae_from_covar")
covar_list <- lapply(obj_list, `[[`, "eval_covar")
# (optional) keep only non-missing covar elements
covar_list <- Filter(Negate(is.null), covar_list)
# bind vertically
covar_all <- do.call(rbind, covar_list)
with(covar_all, mean(rate[asset == 2 & alpha_j == 0.1 & alpha_port == 0.05], na.rm = TRUE))
with(covar_all, mean(rate[asset == 2 & alpha_j == 0.05 & alpha_port == 0.05], na.rm = TRUE))
with(covar_all, mean(rate[asset == 2 & alpha_j == 0.05 & alpha_port == 0.025], na.rm = TRUE))
folder <- "simul_results/SMC/mlNA_w126_wp1000_re001"   # <- change this
files  <- list.files(folder, pattern = "\\.rds$", full.names = TRUE)
# read all files (each file is assumed to be a list)
obj_list <- lapply(files, readRDS)
# extract the element you want (file[[1]]$covar, file[[2]]$covar, ...)
covar_list <- lapply(obj_list, `[[`, "rmse_mae_from_covar")
covar_list <- lapply(obj_list, `[[`, "eval_covar")
# (optional) keep only non-missing covar elements
covar_list <- Filter(Negate(is.null), covar_list)
# bind vertically
covar_all <- do.call(rbind, covar_list)
with(covar_all, mean(rate[asset == 2 & alpha_j == 0.1 & alpha_port == 0.05], na.rm = TRUE))
with(covar_all, mean(rate[asset == 2 & alpha_j == 0.05 & alpha_port == 0.05], na.rm = TRUE))
with(covar_all, mean(rate[asset == 2 & alpha_j == 0.05 & alpha_port == 0.025], na.rm = TRUE))
folder <- "simul_results/SMC/mlNA_w252_wp1000_re001"   # <- change this
files  <- list.files(folder, pattern = "\\.rds$", full.names = TRUE)
# read all files (each file is assumed to be a list)
obj_list <- lapply(files, readRDS)
# extract the element you want (file[[1]]$covar, file[[2]]$covar, ...)
covar_list <- lapply(obj_list, `[[`, "rmse_mae_from_covar")
covar_list <- lapply(obj_list, `[[`, "eval_covar")
# (optional) keep only non-missing covar elements
covar_list <- Filter(Negate(is.null), covar_list)
# bind vertically
covar_all <- do.call(rbind, covar_list)
with(covar_all, mean(rate[asset == 2 & alpha_j == 0.1 & alpha_port == 0.05], na.rm = TRUE))
with(covar_all, mean(rate[asset == 2 & alpha_j == 0.05 & alpha_port == 0.05], na.rm = TRUE))
with(covar_all, mean(rate[asset == 2 & alpha_j == 0.05 & alpha_port == 0.025], na.rm = TRUE))
folder <- "simul_results/SMC/mlNA_w252_wp1000_re001"   # <- change this
files  <- list.files(folder, pattern = "\\.rds$", full.names = TRUE)
# read all files (each file is assumed to be a list)
obj_list <- lapply(files, readRDS)
# extract the element you want (file[[1]]$covar, file[[2]]$covar, ...)
covar_list <- lapply(obj_list, `[[`, "rmse_mae_from_covar")
# (optional) keep only non-missing covar elements
covar_list <- Filter(Negate(is.null), covar_list)
# bind vertically
covar_all <- do.call(rbind, covar_list)
with(covar_all, mean(RMSE[cond_asset == 2 & scenario == "a0.1b0.05"], na.rm = TRUE))
with(covar_all, mean(MAE[cond_asset == 2 & scenario == "a0.1b0.05"], na.rm = TRUE))
with(covar_all, mean(RMSE[cond_asset == 2 & scenario == "a0.05b0.05"], na.rm = TRUE))
with(covar_all, mean(MAE[cond_asset == 2 & scenario == "a0.05b0.05"], na.rm = TRUE))
with(covar_all, mean(RMSE[cond_asset == 2 & scenario == "a0.05b0.025"], na.rm = TRUE))
with(covar_all, mean(MAE[cond_asset == 2 & scenario == "a0.05b0.025"], na.rm = TRUE))
folder <- "simul_results/SMC_500/mlNA_w252_wp1000_re001"   # <- change this
files  <- list.files(folder, pattern = "\\.rds$", full.names = TRUE)
# read all files (each file is assumed to be a list)
obj_list <- lapply(files, readRDS)
# extract the element you want (file[[1]]$covar, file[[2]]$covar, ...)
covar_list <- lapply(obj_list, `[[`, "rmse_mae_from_covar")
covar_list <- lapply(obj_list, `[[`, "eval_covar")
# (optional) keep only non-missing covar elements
covar_list <- Filter(Negate(is.null), covar_list)
# bind vertically
covar_all <- do.call(rbind, covar_list)
with(covar_all, mean(rate[asset == 2 & alpha_j == 0.1 & alpha_port == 0.05], na.rm = TRUE))
with(covar_all, mean(rate[asset == 2 & alpha_j == 0.05 & alpha_port == 0.05], na.rm = TRUE))
with(covar_all, mean(rate[asset == 2 & alpha_j == 0.05 & alpha_port == 0.025], na.rm = TRUE))
folder <- "simul_results/SMC_500/mlNA_w252_wp1000_re001"   # <- change this
files  <- list.files(folder, pattern = "\\.rds$", full.names = TRUE)
# read all files (each file is assumed to be a list)
obj_list <- lapply(files, readRDS)
# extract the element you want (file[[1]]$covar, file[[2]]$covar, ...)
covar_list <- lapply(obj_list, `[[`, "rmse_mae_from_covar")
# (optional) keep only non-missing covar elements
covar_list <- Filter(Negate(is.null), covar_list)
# bind vertically
covar_all <- do.call(rbind, covar_list)
with(covar_all, mean(RMSE[cond_asset == 2 & scenario == "a0.1b0.05"], na.rm = TRUE))
with(covar_all, mean(MAE[cond_asset == 2 & scenario == "a0.1b0.05"], na.rm = TRUE))
with(covar_all, mean(RMSE[cond_asset == 2 & scenario == "a0.05b0.05"], na.rm = TRUE))
with(covar_all, mean(MAE[cond_asset == 2 & scenario == "a0.05b0.05"], na.rm = TRUE))
with(covar_all, mean(RMSE[cond_asset == 2 & scenario == "a0.05b0.025"], na.rm = TRUE))
with(covar_all, mean(MAE[cond_asset == 2 & scenario == "a0.05b0.025"], na.rm = TRUE))
folder <- "simul_results/NAIVE/mlNA_w252_wp0252_re063"   # <- change this
files  <- list.files(folder, pattern = "\\.rds$", full.names = TRUE)
obj_list <- lapply(files, readRDS)
covar_list <- lapply(obj_list, `[[`, "rmse_mae_from_covar")
covar_list <- lapply(obj_list, `[[`, "eval_covar")
covar_list <- Filter(Negate(is.null), covar_list)
covar_all <- do.call(rbind, covar_list)
with(covar_all, mean(rate[asset == 2 & alpha_j == 0.1 & alpha_port == 0.05], na.rm = TRUE))
with(covar_all, mean(rate[asset == 2 & alpha_j == 0.05 & alpha_port == 0.05], na.rm = TRUE))
with(covar_all, mean(rate[asset == 2 & alpha_j == 0.05 & alpha_port == 0.025], na.rm = TRUE))
folder <- "simul_results/NAIVE/mlNA_w252_wp0252_re063"   # <- change this
files  <- list.files(folder, pattern = "\\.rds$", full.names = TRUE)
obj_list <- lapply(files, readRDS)
covar_list <- lapply(obj_list, `[[`, "rmse_mae_from_covar")
covar_list <- Filter(Negate(is.null), covar_list)
covar_all <- do.call(rbind, covar_list)
with(covar_all, mean(RMSE[cond_asset == 2 & scenario == "a0.1b0.05"], na.rm = TRUE))
with(covar_all, mean(MAE[cond_asset == 2 & scenario == "a0.1b0.05"], na.rm = TRUE))
with(covar_all, mean(RMSE[cond_asset == 2 & scenario == "a0.05b0.05"], na.rm = TRUE))
with(covar_all, mean(MAE[cond_asset == 2 & scenario == "a0.05b0.05"], na.rm = TRUE))
with(covar_all, mean(RMSE[cond_asset == 2 & scenario == "a0.05b0.025"], na.rm = TRUE))
with(covar_all, mean(MAE[cond_asset == 2 & scenario == "a0.05b0.025"], na.rm = TRUE))
folder <- "simul_results/NAIVE/mlNA_w252_wp0252_re252"   # <- change this
files  <- list.files(folder, pattern = "\\.rds$", full.names = TRUE)
obj_list <- lapply(files, readRDS)
covar_list <- lapply(obj_list, `[[`, "rmse_mae_from_covar")
covar_list <- lapply(obj_list, `[[`, "eval_covar")
covar_list <- Filter(Negate(is.null), covar_list)
covar_all <- do.call(rbind, covar_list)
with(covar_all, mean(rate[asset == 2 & alpha_j == 0.1 & alpha_port == 0.05], na.rm = TRUE))
with(covar_all, mean(rate[asset == 2 & alpha_j == 0.05 & alpha_port == 0.05], na.rm = TRUE))
with(covar_all, mean(rate[asset == 2 & alpha_j == 0.05 & alpha_port == 0.025], na.rm = TRUE))
folder <- "simul_results/NAIVE/mlNA_w252_wp0252_re252"   # <- change this
files  <- list.files(folder, pattern = "\\.rds$", full.names = TRUE)
obj_list <- lapply(files, readRDS)
covar_list <- lapply(obj_list, `[[`, "rmse_mae_from_covar")
covar_list <- Filter(Negate(is.null), covar_list)
covar_all <- do.call(rbind, covar_list)
with(covar_all, mean(RMSE[cond_asset == 2 & scenario == "a0.1b0.05"], na.rm = TRUE))
with(covar_all, mean(MAE[cond_asset == 2 & scenario == "a0.1b0.05"], na.rm = TRUE))
with(covar_all, mean(RMSE[cond_asset == 2 & scenario == "a0.05b0.05"], na.rm = TRUE))
with(covar_all, mean(MAE[cond_asset == 2 & scenario == "a0.05b0.05"], na.rm = TRUE))
with(covar_all, mean(RMSE[cond_asset == 2 & scenario == "a0.05b0.025"], na.rm = TRUE))
with(covar_all, mean(MAE[cond_asset == 2 & scenario == "a0.05b0.025"], na.rm = TRUE))
folder <- "simul_results/NAIVE/ml500_w252_wp0252_re252"   # <- change this
files  <- list.files(folder, pattern = "\\.rds$", full.names = TRUE)
obj_list <- lapply(files, readRDS)
covar_list <- lapply(obj_list, `[[`, "rmse_mae_from_covar")
covar_list <- lapply(obj_list, `[[`, "eval_covar")
covar_list <- Filter(Negate(is.null), covar_list)
covar_all <- do.call(rbind, covar_list)
with(covar_all, mean(rate[asset == 2 & alpha_j == 0.1 & alpha_port == 0.05], na.rm = TRUE))
with(covar_all, mean(rate[asset == 2 & alpha_j == 0.05 & alpha_port == 0.05], na.rm = TRUE))
with(covar_all, mean(rate[asset == 2 & alpha_j == 0.05 & alpha_port == 0.025], na.rm = TRUE))
folder <- "simul_results/NAIVE/ml500_w252_wp0252_re252"   # <- change this
files  <- list.files(folder, pattern = "\\.rds$", full.names = TRUE)
obj_list <- lapply(files, readRDS)
covar_list <- lapply(obj_list, `[[`, "rmse_mae_from_covar")
covar_list <- Filter(Negate(is.null), covar_list)
covar_all <- do.call(rbind, covar_list)
with(covar_all, mean(RMSE[cond_asset == 2 & scenario == "a0.1b0.05"], na.rm = TRUE))
with(covar_all, mean(MAE[cond_asset == 2 & scenario == "a0.1b0.05"], na.rm = TRUE))
with(covar_all, mean(RMSE[cond_asset == 2 & scenario == "a0.05b0.05"], na.rm = TRUE))
with(covar_all, mean(MAE[cond_asset == 2 & scenario == "a0.05b0.05"], na.rm = TRUE))
with(covar_all, mean(RMSE[cond_asset == 2 & scenario == "a0.05b0.025"], na.rm = TRUE))
with(covar_all, mean(MAE[cond_asset == 2 & scenario == "a0.05b0.025"], na.rm = TRUE))
folder <- "simul_results/SMC/ml500_w252_wp1000_re001"   # <- change this
files  <- list.files(folder, pattern = "\\.rds$", full.names = TRUE)
# read all files (each file is assumed to be a list)
obj_list <- lapply(files, readRDS)
# extract the element you want (file[[1]]$covar, file[[2]]$covar, ...)
covar_list <- lapply(obj_list, `[[`, "rmse_mae_from_covar")
covar_list <- lapply(obj_list, `[[`, "eval_covar")
# (optional) keep only non-missing covar elements
covar_list <- Filter(Negate(is.null), covar_list)
# bind vertically
covar_all <- do.call(rbind, covar_list)
with(covar_all, mean(rate[asset == 2 & alpha_j == 0.1 & alpha_port == 0.05], na.rm = TRUE))
with(covar_all, mean(rate[asset == 2 & alpha_j == 0.05 & alpha_port == 0.05], na.rm = TRUE))
with(covar_all, mean(rate[asset == 2 & alpha_j == 0.05 & alpha_port == 0.025], na.rm = TRUE))
folder <- "simul_results/SMC/ml500_w252_wp1000_re001"   # <- change this
files  <- list.files(folder, pattern = "\\.rds$", full.names = TRUE)
# read all files (each file is assumed to be a list)
obj_list <- lapply(files, readRDS)
# extract the element you want (file[[1]]$covar, file[[2]]$covar, ...)
covar_list <- lapply(obj_list, `[[`, "rmse_mae_from_covar")
# (optional) keep only non-missing covar elements
covar_list <- Filter(Negate(is.null), covar_list)
# bind vertically
covar_all <- do.call(rbind, covar_list)
with(covar_all, mean(RMSE[cond_asset == 2 & scenario == "a0.1b0.05"], na.rm = TRUE))
with(covar_all, mean(MAE[cond_asset == 2 & scenario == "a0.1b0.05"], na.rm = TRUE))
with(covar_all, mean(RMSE[cond_asset == 2 & scenario == "a0.05b0.05"], na.rm = TRUE))
with(covar_all, mean(MAE[cond_asset == 2 & scenario == "a0.05b0.05"], na.rm = TRUE))
with(covar_all, mean(RMSE[cond_asset == 2 & scenario == "a0.05b0.025"], na.rm = TRUE))
with(covar_all, mean(MAE[cond_asset == 2 & scenario == "a0.05b0.025"], na.rm = TRUE))
folder <- "simul_results/NAIVE/ml500_w252_wp0252_re063"   # <- change this
files  <- list.files(folder, pattern = "\\.rds$", full.names = TRUE)
obj_list <- lapply(files, readRDS)
covar_list <- lapply(obj_list, `[[`, "rmse_mae_from_covar")
covar_list <- lapply(obj_list, `[[`, "eval_covar")
covar_list <- Filter(Negate(is.null), covar_list)
covar_all <- do.call(rbind, covar_list)
with(covar_all, mean(rate[asset == 2 & alpha_j == 0.1 & alpha_port == 0.05], na.rm = TRUE))
with(covar_all, mean(rate[asset == 2 & alpha_j == 0.05 & alpha_port == 0.05], na.rm = TRUE))
with(covar_all, mean(rate[asset == 2 & alpha_j == 0.05 & alpha_port == 0.025], na.rm = TRUE))
folder <- "simul_results/NAIVE/ml500_w252_wp0252_re063"   # <- change this
files  <- list.files(folder, pattern = "\\.rds$", full.names = TRUE)
obj_list <- lapply(files, readRDS)
covar_list <- lapply(obj_list, `[[`, "rmse_mae_from_covar")
covar_list <- Filter(Negate(is.null), covar_list)
covar_all <- do.call(rbind, covar_list)
with(covar_all, mean(RMSE[cond_asset == 2 & scenario == "a0.1b0.05"], na.rm = TRUE))
with(covar_all, mean(MAE[cond_asset == 2 & scenario == "a0.1b0.05"], na.rm = TRUE))
with(covar_all, mean(RMSE[cond_asset == 2 & scenario == "a0.05b0.05"], na.rm = TRUE))
with(covar_all, mean(MAE[cond_asset == 2 & scenario == "a0.05b0.05"], na.rm = TRUE))
with(covar_all, mean(RMSE[cond_asset == 2 & scenario == "a0.05b0.025"], na.rm = TRUE))
with(covar_all, mean(MAE[cond_asset == 2 & scenario == "a0.05b0.025"], na.rm = TRUE))
0.01489722/0.01967123-1
folder <- "simul_results/SMC/ml500_w252_wp1000_re001"   # <- change this
files  <- list.files(folder, pattern = "\\.rds$", full.names = TRUE)
# read all files (each file is assumed to be a list)
obj_list <- lapply(files, readRDS)
# extract the element you want (file[[1]]$covar, file[[2]]$covar, ...)
covar_list <- lapply(obj_list, `[[`, "rmse_mae_from_covar")
covar_list <- lapply(obj_list, `[[`, "eval_covar")
# (optional) keep only non-missing covar elements
covar_list <- Filter(Negate(is.null), covar_list)
# bind vertically
covar_all <- do.call(rbind, covar_list)
with(covar_all, mean(rate[asset == 2 & alpha_j == 0.1 & alpha_port == 0.05], na.rm = TRUE))
with(covar_all, mean(rate[asset == 2 & alpha_j == 0.05 & alpha_port == 0.05], na.rm = TRUE))
with(covar_all, mean(rate[asset == 2 & alpha_j == 0.05 & alpha_port == 0.025], na.rm = TRUE))
folder <- "simul_results/SMC/ml500_w504_wp1000_re001"   # <- change this
files  <- list.files(folder, pattern = "\\.rds$", full.names = TRUE)
# read all files (each file is assumed to be a list)
obj_list <- lapply(files, readRDS)
# extract the element you want (file[[1]]$covar, file[[2]]$covar, ...)
covar_list <- lapply(obj_list, `[[`, "rmse_mae_from_covar")
covar_list <- lapply(obj_list, `[[`, "eval_covar")
# (optional) keep only non-missing covar elements
covar_list <- Filter(Negate(is.null), covar_list)
# bind vertically
covar_all <- do.call(rbind, covar_list)
with(covar_all, mean(rate[asset == 2 & alpha_j == 0.1 & alpha_port == 0.05], na.rm = TRUE))
with(covar_all, mean(rate[asset == 2 & alpha_j == 0.05 & alpha_port == 0.05], na.rm = TRUE))
with(covar_all, mean(rate[asset == 2 & alpha_j == 0.05 & alpha_port == 0.025], na.rm = TRUE))
folder <- "simul_results/SMC/ml500_w126_wp1000_re001"   # <- change this
files  <- list.files(folder, pattern = "\\.rds$", full.names = TRUE)
# read all files (each file is assumed to be a list)
obj_list <- lapply(files, readRDS)
# extract the element you want (file[[1]]$covar, file[[2]]$covar, ...)
covar_list <- lapply(obj_list, `[[`, "rmse_mae_from_covar")
covar_list <- lapply(obj_list, `[[`, "eval_covar")
# (optional) keep only non-missing covar elements
covar_list <- Filter(Negate(is.null), covar_list)
# bind vertically
covar_all <- do.call(rbind, covar_list)
with(covar_all, mean(rate[asset == 2 & alpha_j == 0.1 & alpha_port == 0.05], na.rm = TRUE))
with(covar_all, mean(rate[asset == 2 & alpha_j == 0.05 & alpha_port == 0.05], na.rm = TRUE))
with(covar_all, mean(rate[asset == 2 & alpha_j == 0.05 & alpha_port == 0.025], na.rm = TRUE))
folder <- "simul_results/SMC/ml1000_w252_wp1000_re001"   # <- change this
files  <- list.files(folder, pattern = "\\.rds$", full.names = TRUE)
# read all files (each file is assumed to be a list)
obj_list <- lapply(files, readRDS)
# extract the element you want (file[[1]]$covar, file[[2]]$covar, ...)
covar_list <- lapply(obj_list, `[[`, "rmse_mae_from_covar")
covar_list <- lapply(obj_list, `[[`, "eval_covar_asset")
# (optional) keep only non-missing covar elements
covar_list <- Filter(Negate(is.null), covar_list)
# bind vertically
covar_all <- do.call(rbind, covar_list)
with(covar_all, mean(rate[asset == 2 & alpha_j == 0.1 & alpha_port == 0.05], na.rm = TRUE))
folder <- "simul_results/SMC/mlNA_w252_wp1000_re001"   # <- change this
files  <- list.files(folder, pattern = "\\.rds$", full.names = TRUE)
# read all files (each file is assumed to be a list)
obj_list <- lapply(files, readRDS)
# extract the element you want (file[[1]]$covar, file[[2]]$covar, ...)
covar_list <- lapply(obj_list, `[[`, "rmse_mae_from_covar")
covar_list <- lapply(obj_list, `[[`, "eval_covar_asset")
# (optional) keep only non-missing covar elements
covar_list <- Filter(Negate(is.null), covar_list)
# bind vertically
covar_all <- do.call(rbind, covar_list)
with(covar_all, mean(rate[asset == 2 & alpha_j == 0.1 & alpha_port == 0.05], na.rm = TRUE))
with(covar_all, mean(rate[asset == 2 & alpha_j == 0.05 & alpha_port == 0.05], na.rm = TRUE))
with(covar_all, mean(rate[asset == 2 & alpha_j == 0.05 & alpha_port == 0.025], na.rm = TRUE))
folder <- "simul_results/NAIVE/mlNA_w252_wp0252_re252"   # <- change this
files  <- list.files(folder, pattern = "\\.rds$", full.names = TRUE)
obj_list <- lapply(files, readRDS)
covar_list <- lapply(obj_list, `[[`, "rmse_mae_from_covar")
covar_list <- lapply(obj_list, `[[`, "eval_covar_asset")
covar_list <- Filter(Negate(is.null), covar_list)
covar_all <- do.call(rbind, covar_list)
with(covar_all, mean(rate[asset == 2 & alpha_j == 0.1 & alpha_port == 0.05], na.rm = TRUE))
with(covar_all, mean(rate[asset == 2 & alpha_j == 0.05 & alpha_port == 0.05], na.rm = TRUE))
with(covar_all, mean(rate[asset == 2 & alpha_j == 0.05 & alpha_port == 0.025], na.rm = TRUE))
